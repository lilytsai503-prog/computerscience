<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Tracker</title>
    <link rel="stylesheet" href="style.css">

    <style>
        .header-bar { background-color: transparent; }

        .cup-container {
            width: 120px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .cup {
            width: 100%;
            height: 100%;
            border: 3px solid #3fa9f5;
            border-radius: 0 0 20px 20px;
            position: relative;
            overflow: hidden;
        }
      
        .water {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: #3fa9f5aa;
            transition: height 0.4s ease;
        }
    </style>
</head>

<body>
    <div id="overlay" onclick="closeNav()"></div>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="index.html">ðŸ“Š Dashboard</a>
        <a href="profile.html">ðŸ‘¤ User Profile</a>
        <a href="water.html" style="color:white">ðŸ’§ Water Tracker</a>
        <a href="sedentary.html">ðŸª‘ Sedentary Timer</a>
        <a href="sleep.html">ðŸ˜´ Sleep Manager</a>
    </div>

    <div class="header-bar">
        <span class="menu-icon" onclick="openNav()">&#9776;</span>
    </div>

    <div class="container" style="margin-top:0;">
        <h2>ðŸ’§ Water Tracker</h2>
        <p style="color:#666;font-size:0.9em;">
            Record your daily water intake. The cup below will decrease as you drink more water today.
        </p>

        <div class="cup-container">
            <div class="cup">
                <div id="cupWater" class="water"></div>
            </div>
        </div>

        <label>Amount (ml):</label>
        <input type="number" id="waterAmount" placeholder="e.g., 250">

        <button id="addWaterBtn">Add</button>

        <div id="alertBox" style="text-align:center;margin-top:10px;"></div>

        <hr style="border:0;border-top:1px solid #eee;margin:20px 0;">

        <h3>History</h3>
        <div id="summary" style="text-align:center;color:#666;margin-bottom:10px;">No records yet.</div>

        <div style="overflow-x:auto;">
            <table id="recordsTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Amount (ml)</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div style="text-align:center;margin-top:20px;">
            <button id="clearBtn" class="danger-btn small">Clear History</button>
        </div>
    </div>

    <script>
        function openNav(){ document.getElementById("mySidenav").style.width = "250px"; document.getElementById("overlay").style.display = "block"; }
        function closeNav(){ document.getElementById("mySidenav").style.width = "0"; document.getElementById("overlay").style.display = "none"; }

        const waterAmount = document.getElementById('waterAmount');
        const addBtn = document.getElementById('addWaterBtn');
        const clearBtn = document.getElementById('clearBtn');
        const recordsTableBody = document.querySelector('#recordsTable tbody');
        const summary = document.getElementById('summary');
        const alertBox = document.getElementById('alertBox');
        const cupWater = document.getElementById('cupWater');

        let records = JSON.parse(localStorage.getItem('waterRecords') || '[]');
        render();

        const dailyGoal = 2000;

        function getTodayTotal(){
            const today = new Date().toLocaleDateString();
            return records.filter(r => r.date === today).reduce((a,b)=>a+b.amount,0);
        }

        function updateCup(){
            const total = getTodayTotal();
            const ratio = Math.min(total / dailyGoal, 1);
            const height = 100 - ratio * 100;  // è¶Šå–è¶Šä½Ž
            cupWater.style.height = height + "%";
        }

        addBtn.addEventListener('click', ()=>{
            alertBox.innerHTML = "";
            const amount = Number(waterAmount.value);
            if(amount <= 0) return alert("Please enter a valid amount.");

            const item = {
                id: Date.now(),
                amount,
                date: new Date().toLocaleDateString()
            };

            records.unshift(item);
            localStorage.setItem('waterRecords', JSON.stringify(records));
            waterAmount.value = "";
            render();

            alertBox.innerHTML = `<span class="badge ok">+${amount} ml</span>`;
        });

        clearBtn.addEventListener('click', ()=>{
            if(!confirm("Clear all history?")) return;
            records = [];
            localStorage.removeItem('waterRecords');
            render();
        });

        function render(){
            recordsTableBody.innerHTML = "";
            if(records.length === 0){
                summary.style.display = "block";
            } else {
                summary.style.display = "none";
            }

            for(const r of records){
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${r.date}</td>
                    <td>${r.amount}</td>
                    <td style="text-align:center">
                        <button class="danger-btn small" onclick="deleteRecord(${r.id})">Ã—</button>
                    </td>
                `;
                recordsTableBody.appendChild(tr);
            }

            updateCup();
        }

        window.deleteRecord = function(id){
            records = records.filter(x => x.id !== id);
            localStorage.setItem('waterRecords', JSON.stringify(records));
            render();
        };
    </script>
</body>
</html>
